{% extends 'base.html' %}
{% block content %}

<!-- Calculator Section -->
<section id="calculator-section">
  <p>Select your desired permits and click <b>Calculate</b> to estimate your chances of 
    securing a camping permit. Data is based on 2024 results.
  </p>
  <form method="POST">
<!-- Error Message Display -->
{% if error_message %}
  <div class="error-message">{{ error_message }}</div>
{% endif %}

<!-- Container for the 3 combos -->
<div class="combo-container">
  <div id="combo">
    <p id="selection">Permit Selection 1</p>
    <label for="date1">Date:</label>
    <input type="date" id="date1" name="date1" value="{{ selected_combos[0][0] or '2025-08-02' }}" required>
    <label for="zone1">Zone:</label>
    <select id="zone1" name="zone1" required>
      <option value="Eightmile Zone" {% if selected_combos[0][1] == 'Eightmile Zone' %}selected{% endif %}>Eightmile Zone</option>
      <option value="Stuart Zone" {% if selected_combos[0][1] == 'Stuart Zone' %}selected{% endif %}>Stuart Zone</option>
      <option value="Colchuck Zone" {% if selected_combos[0][1] == 'Colchuck Zone' %}selected{% endif %}>Colchuck Zone</option>
      <option value="Core Enchantment Zone" {% if selected_combos[0][1] == 'Core Enchantment Zone' %}selected{% elif not selected_combos[0][1] %}selected{% endif %}>Core Enchantment Zone</option>
      <option value="Snow Zone" {% if selected_combos[0][1] == 'Snow Zone' %}selected{% endif %}>Snow Zone</option>
    </select>
    <!-- Display the probability for the selected combo -->
    <p>Permit Awarded: <b>{{individual_probabilities[0]}}%</b></p>
  </div>

  <div id="combo">
    <p id="selection">Permit Selection 2</p>
    <label for="date2">Date:</label>
    <input type="date" id="date2" name="date2" value="{{ selected_combos[1][0] or '2025-08-02' }}" required>
    <label for="zone2">Zone:</label>
    <select id="zone2" name="zone2" required>
      <option value="Eightmile Zone" {% if selected_combos[1][1] == 'Eightmile Zone' %}selected{% endif %}>Eightmile Zone</option>
      <option value="Stuart Zone" {% if selected_combos[1][1] == 'Stuart Zone' %}selected{% endif %}>Stuart Zone</option>
      <option value="Colchuck Zone" {% if selected_combos[1][1] == 'Colchuck Zone' %}selected{% elif not selected_combos[1][1] %}selected{% endif %}>Colchuck Zone</option>
      <option value="Core Enchantment Zone" {% if selected_combos[1][1] == 'Core Enchantment Zone' %}selected{% endif %}>Core Enchantment Zone</option>
      <option value="Snow Zone" {% if selected_combos[1][1] == 'Snow Zone' %}selected{% endif %}>Snow Zone</option>
    </select>
    <p>Permit Awarded: <b>{{individual_probabilities[1]}}%</b></p>
  </div>

  <div id="combo">
    <p id="selection">Permit Selection 3</p>
    <label for="date3">Date:</label>
    <input type="date" id="date3" name="date3" value="{{ selected_combos[2][0] or '2025-08-02' }}" required>
    <label for="zone3">Zone:</label>
    <select id="zone3" name="zone3" required>
      <option value="Eightmile Zone" {% if selected_combos[2][1] == 'Eightmile Zone' %}selected{% endif %}>Eightmile Zone</option>
      <option value="Stuart Zone" {% if selected_combos[2][1] == 'Stuart Zone' %}selected{% endif %}>Stuart Zone</option>
      <option value="Colchuck Zone" {% if selected_combos[2][1] == 'Colchuck Zone' %}selected{% endif %}>Colchuck Zone</option>
      <option value="Core Enchantment Zone" {% if selected_combos[2][1] == 'Core Enchantment Zone' %}selected{% endif %}>Core Enchantment Zone</option>
      <option value="Snow Zone" {% if selected_combos[2][1] == 'Snow Zone' %}selected{% elif not selected_combos[2][1] %}selected{% endif %}>Snow Zone</option>
    </select>
    <p>Permit Awarded: <b>{{individual_probabilities[2]}}%</b></p>
  </div>
</div>

<button type="submit">Calculate</button>

<div class="probability-display">
  <div id="total-probability">
    <h3>Permit Success Chance: </h3>
  </div>
  <div class="progress-bar-container">
    <div class="progress-bar" id="progress-bar" style="width: {{ total_probability or 4.1 }}%;">{{ total_probability or 4 }}%</div>
  </div>
</div>
</section>

<!-- Static Article Section -->
<section id="article-section">
  <h2>Lottery Process Overview</h2>
  <p>
    Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
  </p>
</section>

{% endblock %}